<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rabbit Miner Pro - Full Version</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #ff9800;
            --primary-glow: rgba(255, 152, 0, 0.6);
            --bg: #08080a;
            --card-bg: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
            --text-secondary: #a0a0a0;
            --text-active: #ff9800;
        }

        body {
            margin: 0;
            background: radial-gradient(circle at top, #1a1a1f 0%, #08080a 100%);
            color: white;
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Top Bar */
        .top-bar { padding: 25px 20px; text-align: center; }
        .balance-area { display: flex; align-items: center; justify-content: center; gap: 12px; }
        #coins {
            font-size: 42px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            background: linear-gradient(to bottom, #fff, var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stats-grid {
            display: grid; grid-template-columns: 1fr 1fr;
            gap: 15px; margin-top: 20px; padding: 0 20px;
        }
        .stat-box {
            background: var(--card-bg); border: 1px solid var(--border);
            padding: 12px; border-radius: 16px; backdrop-filter: blur(10px);
        }
        .stat-box small { display: block; color: var(--text-secondary); font-size: 10px; text-transform: uppercase; margin-bottom: 4px; }

        /* Pages */
        .page {
            display: none; flex-direction: column; align-items: center;
            flex: 1; overflow-y: auto; padding-bottom: 120px;
        }
        .active-page { display: flex; animation: slideUp 0.4s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* White Rabbit Design */
        .rabbit-outer {
            width: 280px; height: 280px; border-radius: 50%;
            background: rgba(255, 152, 0, 0.05);
            display: flex; align-items: center; justify-content: center;
            border: 1px solid rgba(255, 152, 0, 0.1); margin: 30px 0;
        }
        .rabbit-main {
            width: 220px; height: 220px;
            background: #ffffff; /* ‡¶∏‡¶æ‡¶¶‡¶æ ‡¶ñ‡¶∞‡¶ó‡ßã‡¶∂ */
            border-radius: 50% 50% 45% 45%;
            position: relative; cursor: pointer;
            box-shadow: 0 0 40px rgba(255,255,255,0.2);
            transition: transform 0.1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        /* ‡¶ï‡¶æ‡¶® */
        .rabbit-main::before, .rabbit-main::after {
            content: ''; position: absolute; top: -50px; width: 45px; height: 100px;
            background: #fff; border-radius: 50% 50% 10% 10%;
        }
        .rabbit-main::before { left: 40px; transform: rotate(-15deg); }
        .rabbit-main::after { right: 40px; transform: rotate(15deg); }
        /* ‡¶Æ‡ßÅ‡¶ñ‡ßá ‡¶ó‡¶æ‡¶ú‡¶∞ */
        .carrot-mouth {
            position: absolute; top: 100px; left: 50%;
            transform: translateX(-50%) rotate(20deg); font-size: 50px;
        }

        .tapped { transform: scale(0.9) !important; }

        /* Energy Bar */
        .energy-container { width: 280px; text-align: center; }
        .energy-bar-bg { height: 18px; background: rgba(0,0,0,0.5); border-radius: 10px; overflow: hidden; border: 1px solid var(--border); margin: 10px 0; }
        #energy-fill { height: 100%; background: linear-gradient(90deg, var(--primary), #f57c00); width: 100%; transition: width 0.3s; }

        /* Buttons & Cards */
        .btn-prime {
            background: linear-gradient(90deg, #ff9800, #f57c00);
            color: white; border: none; padding: 14px 25px; border-radius: 16px;
            font-weight: 600; font-family: 'Inter', sans-serif; cursor: pointer;
            box-shadow: 0 5px 15px rgba(255,152,0,0.3);
        }
        .task-card {
            width: 90%; background: var(--card-bg); border: 1px solid var(--border);
            padding: 18px; border-radius: 20px; margin-bottom: 12px;
            display: flex; justify-content: space-between; align-items: center;
        }

        /* Nav Bar Animation */
        .nav-bar {
            position: fixed; bottom: 20px; left: 5%; width: 90%; height: 80px;
            background: rgba(15,15,18,0.95); border-radius: 30px;
            display: flex; justify-content: space-around; align-items: center;
            border: 1px solid var(--border); backdrop-filter: blur(20px); z-index: 1000;
        }
        .nav-item {
            background: none; border: none; color: #666; font-size: 11px;
            font-weight: bold; display: flex; flex-direction: column; align-items: center;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        .nav-item span { font-size: 28px; margin-bottom: 4px; transition: 0.3s; }
        .nav-item.active { color: var(--primary); transform: translateY(-8px) scale(1.1); }
        .nav-item.active span { filter: drop-shadow(0 0 10px var(--primary-glow)); }

        .float { position: absolute; color: white; font-weight: bold; font-family: 'Orbitron'; font-size: 28px; pointer-events: none; animation: floatUp 0.8s forwards; z-index: 2000; }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-150px); } }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="balance-area">
            <span id="coins">0</span>
        </div>
        <div class="stats-grid">
            <div class="stat-box"><small>Profit / Hr</small><b id="pph">0</b></div>
            <div class="stat-box"><small>Recharge</small><b>1/sec</b></div>
        </div>
    </div>

    <div id="home" class="page active-page">
        <div class="rabbit-outer">
            <div class="rabbit-main" id="tap-btn">
                <div class="carrot-mouth">ü•ï</div>
            </div>
        </div>
        <div class="energy-container">
            <div id="energy-text" style="font-weight:bold; font-size:18px;">1000 / 1000</div>
            <div class="energy-bar-bg"><div id="energy-fill"></div></div>
        </div>
        <button class="btn-prime" style="margin-top: 20px; width: 250px;" id="daily-btn">Claim Daily Reward</button>
    </div>

    <div id="upgrade" class="page">
        <h2 style="font-family: 'Orbitron'; margin-top: 20px;">Upgrades</h2>
        <div id="upgrade-list" style="width: 100%; display: flex; flex-direction: column; align-items: center;"></div>
    </div>

    <div id="tasks" class="page">
        <h2 style="font-family: 'Orbitron'; margin-top: 20px;">Tasks</h2>
        <p style="color: #888;">Join our channels to earn</p>
        
        <div class="task-card">
            <div><b>Join Channel</b><br><small style="color:var(--primary)">+5,000 ü•ï</small></div>
            <button class="btn-prime" onclick="openTask(1, 'https://t.me/jkt_earning_zone20')">Join</button>
            <button class="btn-prime" id="check-1" style="display:none; background:#333;" onclick="verifyTask(1, 5000)">Check</button>
        </div>

        <div class="task-card">
            <div><b>Join Group</b><br><small style="color:var(--primary)">+3,000 ü•ï</small></div>
            <button class="btn-prime" onclick="openTask(2, 'https://t.me/+cAq8TiohRXIzZmFl')">Join</button>
            <button class="btn-prime" id="check-2" style="display:none; background:#333;" onclick="verifyTask(2, 3000)">Check</button>
        </div>
    </div>

    <div id="profile" class="page">
        <h2 style="font-family: 'Orbitron'; margin-top: 20px;">Your Stats</h2>
        <div class="stat-box" style="width: 80%; padding: 30px; text-align: center; margin-top: 20px;">
            <small>Total Carrots</small>
            <h1 id="stat-coins" style="color:var(--primary); font-family:'Orbitron';">0</h1>
            <button class="btn-prime" style="width:100%; margin-top:20px;">Withdraw</button>
        </div>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="nav('home', this)"><span>üè†</span>Home</div>
        <div class="nav-item" onclick="nav('upgrade', this)"><span>‚õèÔ∏è</span>Upgrade</div>
        <div class="nav-item" onclick="nav('tasks', this)"><span>üìã</span>Tasks</div>
        <div class="nav-item" onclick="nav('profile', this)"><span>üìä</span>Stats</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let coins = parseFloat(localStorage.getItem('rb_coins')) || 0;
        let energy = parseFloat(localStorage.getItem('rb_energy')) || 1000;
        let pph = 0;
        const maxEnergy = 1000;

        const upgrades = [
            {id: 'm1', name: 'Rabbit Miner', icon: 'üê∞', level: parseInt(localStorage.getItem('lv_m1') || '0'), cost: 100, profit: 5},
            {id: 'm2', name: 'Carrot Farm', icon: 'ü•ï', level: parseInt(localStorage.getItem('lv_m2') || '0'), cost: 500, profit: 20}
        ];

        function calculateStats() {
            pph = 0;
            upgrades.forEach(u => pph += u.level * u.profit);
            document.getElementById('pph').innerText = pph;
        }

        function renderUpgrades() {
            const list = document.getElementById('upgrade-list');
            list.innerHTML = '';
            upgrades.forEach(u => {
                const currentCost = Math.floor(u.cost * Math.pow(1.5, u.level));
                list.innerHTML += `
                    <div class="task-card">
                        <div>${u.icon} <b>${u.name}</b><br><small>Lv ${u.level} | +${u.profit}/hr</small></div>
                        <button class="btn-prime" onclick="buyUpgrade('${u.id}')">${currentCost}</button>
                    </div>`;
            });
        }

        function buyUpgrade(id) {
            const u = upgrades.find(x => x.id === id);
            const currentCost = Math.floor(u.cost * Math.pow(1.5, u.level));
            if(coins >= currentCost) {
                coins -= currentCost;
                u.level++;
                localStorage.setItem('lv_'+id, u.level);
                calculateStats(); renderUpgrades(); updateUI();
                tg.HapticFeedback.notificationOccurred('success');
            } else { tg.showAlert("Need more carrots!"); }
        }

        function openTask(id, url) {
            tg.openTelegramLink(url);
            event.target.style.display = 'none';
            document.getElementById('check-'+id).style.display = 'block';
        }

        function verifyTask(id, reward) {
            const btn = document.getElementById('check-'+id);
            btn.innerText = "Checking...";
            setTimeout(() => {
                coins += reward;
                btn.innerText = "Claimed ‚úÖ";
                btn.disabled = true;
                updateUI();
                tg.showAlert("You got "+reward+" Carrots!");
            }, 3000);
        }

        const tapBtn = document.getElementById('tap-btn');
        tapBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if(energy >= 1) {
                coins += 1; energy -= 1;
                tapBtn.classList.add('tapped');
                setTimeout(() => tapBtn.classList.remove('tapped'), 100);
                
                const touch = e.touches[0];
                const f = document.createElement('div');
                f.className = 'float'; f.innerText = '+1';
                f.style.left = touch.clientX + 'px'; f.style.top = touch.clientY + 'px';
                document.body.appendChild(f);
                setTimeout(() => f.remove(), 800);
                
                updateUI();
                tg.HapticFeedback.impactOccurred('medium');
            }
        });

        function updateUI() {
            document.getElementById('coins').innerText = Math.floor(coins).toLocaleString();
            document.getElementById('stat-coins').innerText = Math.floor(coins).toLocaleString();
            document.getElementById('energy-fill').style.width = (energy / maxEnergy * 100) + '%';
            document.getElementById('energy-text').innerText = Math.floor(energy) + " / " + maxEnergy;
            localStorage.setItem('rb_coins', coins);
            localStorage.setItem('rb_energy', energy);
        }

        function nav(id, btn) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.getElementById(id).classList.add('active-page');
            btn.classList.add('active');
            tg.HapticFeedback.selectionChanged();
        }

        setInterval(() => {
            coins += (pph / 3600);
            if(energy < maxEnergy) energy += 1;
            updateUI();
        }, 1000);

        calculateStats(); renderUpgrades(); updateUI();
    </script>
</body>
</html>
